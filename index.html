<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Qwen Chat — Hacker Theme</title>
<style>
  body {margin:0; font-family: monospace; background:#050505; color:#00ff88; display:flex; flex-direction:column; height:100vh;}
  .container {flex:1; display:flex; flex-direction:column; max-width:800px; margin:auto; border:1px solid #00ff88; border-radius:12px; overflow:hidden; background:#0b0b0b;}
  header {padding:12px; background:#070707; border-bottom:1px solid #00ff88;}
  header h1 {margin:0; font-size:18px;}
  .messages {flex:1; overflow:auto; padding:12px; display:flex; flex-direction:column; gap:8px;}
  .msg {max-width:70%; padding:10px 12px; border-radius:12px; line-height:1.4; word-break:break-word;}
  .msg.user {align-self:flex-end; background:#00ff88; color:#000;}
  .msg.bot {align-self:flex-start; background:#151515; border:1px solid #00ff88;}
  .composer {display:flex; border-top:1px solid #00ff88; padding:8px;}
  .composer input {flex:1; background:#070707; border:1px solid #00ff88; border-radius:8px; padding:8px; color:#00ff88;}
  .composer button {margin-left:8px; padding:8px 12px; border:none; border-radius:8px; background:#00ff88; color:#000; cursor:pointer;}
  .typing {display:inline-block; width:28px;}
  .dot {display:inline-block; width:6px;height:6px;border-radius:50%; background:#00ff88; margin:0 2px; animation:blink 1s infinite;}
  .dot:nth-child(2){animation-delay:.12s}
  .dot:nth-child(3){animation-delay:.24s}
  @keyframes blink {0%,100%{opacity:.2}50%{opacity:1}}
</style>
</head>
<body>
  <div class="container">
    <header><h1>Qwen Chat — Hacker Theme</h1></header>
    <div id="messages" class="messages"></div>
    <div class="composer">
      <input id="inputMsg" placeholder="Type your message..." />
      <button id="btnSend">Send</button>
    </div>
  </div>

<script>
const messagesEl = document.getElementById('messages');
const input = document.getElementById('inputMsg');
const btnSend = document.getElementById('btnSend');

function escapeHtml(s){ return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

function renderMessage(text, from='bot') {
  const div = document.createElement('div');
  div.className = 'msg ' + from;
  div.innerHTML = escapeHtml(text);
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function showTyping() {
  const node = document.createElement('div');
  node.className = 'msg bot';
  node.id = 'typingNode';
  node.innerHTML = '<span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>';
  messagesEl.appendChild(node);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  return node;
}

function removeTyping() {
  const n = document.getElementById('typingNode');
  if(n) n.remove();
}

async function sendMessage() {
  const text = input.value.trim();
  if(!text) return;
  renderMessage(text, 'user');
  input.value = '';
  const typingNode = showTyping();
  try {
    const resp = await fetch(`https://ai-dex-five.vercel.app/api/qwen?text=${encodeURIComponent(text)}`);
    const data = await resp.json();
    removeTyping();
    renderMessage(data.reply || '[no reply]');
  } catch(err) {
    removeTyping();
    renderMessage('Error: '+err, 'bot');
  }
}

btnSend.addEventListener('click', sendMessage);
input.addEventListener('keydown', e=>{ if(e.key==='Enter') sendMessage(); });

// Welcome message
renderMessage("Hi! I'm your Qwen bot. Ask me anything.");
</script>
</body>
</html>
